# Lecture 8: Discrete Differential Forms

## Overview: The "Discrete" Language
The transition from continuous mathematics to computation on meshes is made powerful by a parallel language: every term in smooth exterior calculus has a corresponding analog in Discrete Exterior Calculus (DEC). By prepending the word "discrete" to our vocabulary (e.g., discrete differential forms), we can move fluidly between continuous geometry and algorithmic implementation.

---

## Motivation: The Hardship of "By-Hand" Calculus
Solving even simple differential equations using pen and paper can be unintuitive and complex.

### Example: Finding a 1-form in $\mathbb{R}^2$
Consider a constant 2-form $\omega = dx \wedge dy$. We want to find a 1-form $\alpha$ such that $d\alpha = \omega$.
1. **Coordinate expansion**: Any 1-form is $\alpha = udx + vdy$.
2. **Exterior derivative**: $d\alpha = du \wedge dx + dv \wedge dy$.
3. **Antisymmetry**: Recall $dx \wedge dy = -dy \wedge dx$.
4. **Solution**: One possible solution is $\alpha = \frac{1}{2}(xdy - ydx)$.

Geometrically, even though $\omega$ is constant, $\alpha$ represents a "swirling" behavior around a point. If the domain involves measured data (like a 3D scan), a closed-form solution is impossible. We must use computation to approximate these solutions.


## The Fundamental Approach of DEC
To turn derivation into computation, we follow three primary replacements:

| Continuous Object | Discrete Analog |
| :--- | :--- |
| **Domain** | **Oriented Simplicial Complex** (Mesh) |
| **Differential $k$-form** | **Values on $k$-simplices** (Simplicial Cochains) |
| **Differential Operator** | **Sparse Matrices** (e.g., Signed Incidence Matrices) |


## Discretization: The de Rham Map
Discretization is the process of turning a continuous object into a finite collection of measurements. In DEC, this is performed by the de Rham map, which integrates a $k$-form over each $k$-simplex.

### $k$-Form Discretization Logic
For each $k$-simplex $\sigma$, the discrete value $\hat{\omega}_\sigma$ is:
$$\hat{\omega}_\sigma := \int_\sigma \omega$$

* **0-forms (Vertices)**: Integrating a 0-form over a vertex simply means sampling the function's value at that point: $\int_v \phi = \phi(p)$.
* **1-forms (Edges)**: Measures the total circulation along an edge. This captures how much the 1-form "lines up" with the oriented edge.
    * **Calculation**: $\hat{\alpha}_e = \int_e \alpha(T)ds$, where $T$ is the unit tangent.
* **2-forms (Triangles)**: Measures alignment and area.
    * **Calculation**: $\int_t \omega = \int_t \omega(T_1, T_2) dA$, using an orthonormal basis $\{T_1, T_2\}$.

> **Note on Orientation**: Discrete values change sign under odd permutations. For an edge $ij$, the discrete 1-form satisfies $\alpha_{ij} = -\alpha_{ji}$.


## Chains and Cochains: Primal vs. Dual
The duality between "things that get measured" and "things that measure" is captured by chains and cochains.

### Simplicial $k$-Chains ($C_k$)
A $k$-chain is a linear combination of $k$-simplices, representing a region of the mesh.
* **Arithmetic**: Chains can be added or subtracted to "fuse" regions or reverse orientations.
* **Formally**: The chain group $C_k$ is the free abelian group generated by $k$-simplices.

### Simplicial $k$-Cochains ($C^k$)
A $k$-cochain is a linear map that takes a $k$-chain and returns a number.
* **Discrete Differential Forms**: A $k$-cochain is exactly what we call a discrete differential $k$-form.
* **Matrix Encoding**: A discrete $k$-form is stored as a column vector with entries corresponding to the number of $k$-simplices.


## Boundary and Coboundary Operators
These operators define how simplices relate to their neighbors of different dimensions.

1. **Boundary Operator ($\partial$)**: Maps a $k$-simplex to a $(k-1)$-chain of its faces.
    * **Fundamental Identity**: The boundary of a boundary is always empty: $\partial \circ \partial = \emptyset$.
2. **Coboundary Operator ($\delta$)**: Maps a $k$-simplex to a collection of $(k+1)$-simplices that contain it and share the same relative orientation.


## Interpolation: The Whitney Map
Interpolation goes in the opposite direction: given discrete measurements, how do we recover a continuous object?

### 0-Forms: Hat Functions
We use the Lagrange basis (or hat function) $\phi_i$, which equals 1 at vertex $i$ and 0 at all other vertices.
$$u(x) = \sum_i u_i \phi_i(x)$$
These functions are explicitly defined by barycentric coordinates.

### $k$-Forms: Whitney Bases
Higher-degree forms are interpolated using Whitney bases, constructed from the derivatives of hat functions.
* **Whitney 1-form**: $\phi_{ij} = \phi_i d\phi_j - \phi_j d\phi_i$.
* **General Whitney $k$-form**: $\sum_{p=0}^k (-1)^p \phi_{i_p} d\phi_{i_0} \wedge \dots \wedge \widehat{d\phi_{i_p}} \wedge \dots \wedge d\phi_{i_k}$.

### Consistency Property
* **Discrete $\to$ Continuous $\to$ Discrete**: If we interpolate a discrete $k$-form with Whitney bases and then discretize it again via the de Rham map, we recover the exact same discrete $k$-form.
* **Continuous $\to$ Discrete $\to$ Continuous**: This does not recover the original form, as discretization inherently involves information loss.

---

## Summary of Operations
* **Discrete Exterior Derivative ($d_k$)**: Encoded as a signed incidence matrix.
* **Discrete Hodge Star ($*_k$)**: Typically encoded as a diagonal matrix of geometric ratios (e.g., dual area / primal area).
* **Building Complexity**: Operators like the Laplacian ($\Delta$) are constructed by composing these matrices: $\Delta = *^{-1}_0 d^T_0 *_{1} d_0$.
